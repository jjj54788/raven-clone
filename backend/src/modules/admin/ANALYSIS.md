# Admin Module Notes

Last updated: 2026-02-15

## Endpoints

Controller: `backend/src/modules/admin/admin.controller.ts`

All routes require **JWT + admin** (`JwtAuthGuard` + `AdminGuard`).

- `GET    /api/v1/admin/auth/settings`
- `PATCH  /api/v1/admin/auth/settings`
- `GET    /api/v1/admin/auth/allowlist`
- `POST   /api/v1/admin/auth/allowlist`
- `DELETE /api/v1/admin/auth/allowlist/:id`
- `GET    /api/v1/admin/users` (`?q=...`)
- `PATCH  /api/v1/admin/users/:id` â€” `{ isAdmin }`

## Notes

- Invite-only sign-ups are stored in `AppSetting` under key `auth.inviteOnly` (DB overrides env overrides default).
- `SignupAllowlistEmail` is used for allowlisted emails.
- Prevents removing the last admin user.

<!-- AUTO-GENERATED:BEGIN -->
## Auto-Generated Snapshot

This section is generated by `scripts/gen-analysis-md.mjs`. Manual edits inside this block will be overwritten.

### Scope
- Directory: `backend/src/modules/admin`

### Detected Routes (NestJS)
- `GET  /api/v1/admin/auth/allowlist` (backend/src/modules/admin/admin.controller.ts)
- `POST /api/v1/admin/auth/allowlist` (backend/src/modules/admin/admin.controller.ts)
- `DELETE /api/v1/admin/auth/allowlist/:id` (backend/src/modules/admin/admin.controller.ts)
- `GET  /api/v1/admin/auth/settings` (backend/src/modules/admin/admin.controller.ts)
- `PATCH /api/v1/admin/auth/settings` (backend/src/modules/admin/admin.controller.ts)
- `GET  /api/v1/admin/users` (backend/src/modules/admin/admin.controller.ts)
- `PATCH /api/v1/admin/users/:id` (backend/src/modules/admin/admin.controller.ts)

### File Tree (depth <= 3)
```text
admin.controller.ts
admin.module.ts
admin.service.ts
ANALYSIS.md
dto/
dto/create-allowlist-email.dto.ts
dto/update-auth-settings.dto.ts
dto/update-user-role.dto.ts
```
<!-- AUTO-GENERATED:END -->
